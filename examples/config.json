{
  "log": {
    "disabled": false,
    "timestamp": true,
    "level": "warn"
  },
  "experimental": {
    "clash_api": {
      "external_controller": "0.0.0.0:9090",
      "external_ui": "/etc/sing-box/ui",
      "external_ui_download_url": "https://gh-proxy.com/https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip",
      "external_ui_download_detour": "direct",
      "secret": "",
      "default_mode": "rule",
      "access_control_allow_origin": ["*"],
      "access_control_allow_private_network": false
    },
    "cache_file": {
      "enabled": true,
      "path": "/etc/sing-box/cache.db",
      "cache_id": "",
      "store_fakeip": true,
      "store_rdrc": true,
      "rdrc_timeout": "7d"
    }
  },
  "dns": {
    "servers": [
      {
        "tag": "google",
        "type": "https",
        "server": "dns.google",
        "domain_resolver": "cloudflare",
        "detour": "auto-gateway"
      },
      {
        "tag": "cloudflare",
        "type": "udp",
        "server": "1.1.1.1"
      }
    ],
    "strategy": "ipv4_only",
    "final": "local"
  },
  "inbounds": [
    {
      "type": "tproxy",
      "listen": "0.0.0.0",
      "listen_port": 12345,
      "tcp_fast_open": true,
      "tcp_multi_path": false,
      "udp_fragment": true,
      "udp_timeout": "300s"
    },
    {
      "type": "socks",
      "listen": "0.0.0.0",
      "listen_port": 1080,
      "sniff": true
    }
  ],
  "outbounds": [
    {
      "tag": "auto-gateway",
      "type": "balancer",
      "url": "https://www.google.com/generate_204",
      "interval": "15s",
      "tolerance": 50,
      "interrupt_exist_connections": true,
      "outbounds": ["outbound-anytls", "outbound-grpc"]
    },
    {
      "tag": "outbound-anytls",
      "type": "anytls",
      "server": "server_domain",
      "server_port": 8443,
      "password": "password",
      "idle_session_check_interval": "30s",
      "idle_session_timeout": "36000s",
      "min_idle_session": 5,
      "routing_mark": 255,
      "tls": {
        "enabled": true,
        "disable_sni": false,
        "server_name": "example.com",
        "insecure": false,
        "utls": {
          "enabled": true,
          "fingerprint": "chrome"
        },
        "reality": {
          "enabled": true,
          "public_key": "the-public",
          "short_id": "the-short_id"
        }
      }
    },
    {
      "tag": "outbound-grpc",
      "type": "vless",
      "server": "server_domain",
      "server_port": 443,
      "uuid": "the-uuid",
      "flow": "",
      "packet_encoding": "",
      "routing_mark": 255,
      "tls": {
        "enabled": true,
        "alpn": ["h2", "http/1.1"],
        "server_name": "the-server-name",
        "utls": {
          "enabled": false,
          "fingerprint": "chrome"
        }
      },
      "transport": {
        "type": "grpc",
        "service_name": "service_name",
        "idle_timeout": "10s",
        "ping_timeout": "1.5s",
        "permit_without_stream": true
      }
    },
    {
      "tag": "union-traffic",
      "type": "socks",
      "server": "127.0.0.1",
      "server_port": 1183,
      "routing_mark": 255
    },
    {
      "tag": "direct",
      "type": "direct",
      "routing_mark": 255
    }
  ],
  "route": {
    "rules": [
      {
        "action": "sniff"
      },
      {
        "protocol": "dns",
        "action": "hijack-dns"
      },
      {
        "action": "reject",
        "rule_set": ["Category-Ads"]
      },
      {
        "action": "route",
        "rule_set": ["GeoSite-CN", "GeoSite-Private", "GeoIP-CN", "GeoIP-Private"],
        "domain_suffix": ["quay.io", "ghcr.io", "pkg-containers.githubusercontent.com", "gstreamer.freedesktop.org"],
        "outbound": "direct"
      },
      {
        "action": "route",
        "rule_set": ["GeoSite-Telegram", "GeoIP-Telegram"],
        "domain_suffix": ["mikrotik.com", "cloudfront.net", "production.cloudflare.docker.com"],
        "outbound": "union-traffic"
      },
      {
        "action": "route",
        "rule_set": ["GeoSite-Gfw"],
        "outbound": "auto-gateway"
      }
    ],
    "rule_set": [
      {
        "tag": "Category-Ads",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geosite/category-ads-all.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoSite-Telegram",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geosite/telegram.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoIP-Telegram",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geoip/telegram.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoSite-CN",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geosite/cn.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoIP-CN",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geoip/cn.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoSite-Private",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geosite/private.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoIP-Private",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geoip/private.json",
        "format": "binary",
        "download_detour": "direct"
      },
      {
        "tag": "GeoSite-Gfw",
        "type": "remote",
        "url": "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@sing/geo/geosite/gfw.json",
        "format": "binary",
        "download_detour": "direct"
      }
    ],
    "default_domain_resolver": "local",
    "auto_detect_interface": true,
    "final": "direct"
  }
}
